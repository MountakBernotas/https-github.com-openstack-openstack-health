<header class="bs-header">
    <div class="container">
        <h1 class="page-header">Tests</h1>
    </div>
</header>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <loading-indicator></loading-indicator>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
        <accordion close-others="false">
            <div class="panel panel-body panel-default" ng-repeat="(key, value) in tests.chartData">
                <div class="panel-heading">
                    <h3 class="panel-title">Test failures for {{ key }}</h3>
                </div>
                <chart-bar data="value" width=100% height="250" show-values="false" show-x-axis="false" force-y="[0,1]" tick-format-x="%"></chart-bar>
                <accordion-group heading="Details for {{ key }}" is-open="acc1open">
                    <div>
                        <form>
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon"><i class="fa fa-search"></i></div>
                                    <input type="text" class="form-control" placeholder="Search for test" ng-model="tests.searchTest">
                                </div>
                            </div>
                        </form>
                        <table table-sort data="tests.chartData[key][0]['tests']" class="table">
                            <thead>
                                <tr>
                                    <th sort-field="test_id" class="text-left">
                                        Test ID
                                    </th>
                                    <th sort-field="success" class="text-right" style="min-width:80px">
                                        Passed
                                    </th>
                                    <th sort-field="failure" class="text-right" style="min-width:80px">
                                        Failed
                                    </th>
                                    <th sort-default sort-field="failureAverage" class="text-right" style="min-width:95px">
                                        Failure %
                                    </th>
                                    <th sort-field="run_time" class="text-right" style="min-width:80px">
                                        Avg. Runtime (secs.)
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr table-ref="table" ng-repeat="test in table.dataSorted | filter:tests.searchTest">
                                    <td class="text-left">
                                      <a href="#">{{ test.test_id | limitTo: 110 }}</a>
                                    </td>
                                    <td class="text-right">{{ test.success | number }}</td>
                                    <td class="text-right">{{ test.failure | number:2 }}</td>
                                    <td class="text-right">{{ test.failureAverage | number: 2 }}</td>
                                    <td class="text-right">{{ test.run_time | number: 2 }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </accordion-group>
            </div>
        </accordion>
        </div>
    </div>
